---
title: "p8105_hw2_pm3148"
author: "Pooja Mukund"
date: "10/6/2021"
output:
  html_document: default
  pdf_document: default
---

#### Load relevant packages
```{r}
library(tidyverse)
library(readxl)
```
## Problem 1
#### Import Mr. Trash Wheel Dataset
```{r}
trash_wheel = read_excel("./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
                         range="A2:N534")

str(trash_wheel)

trash_wheel<- trash_wheel %>%
   janitor::clean_names()
  
trash_wheel_na_clean<- trash_wheel%>%
  drop_na(dumpster)
```

```{r}
trash_wheel_col <- select(trash_wheel_na_clean)

trash_wheel_final<- trash_wheel_na_clean%>%
  mutate(sports_ball_rounded = round(sports_balls, 0))

#Find median number of sports balls in 2019
trash_wheel_final%>%
  filter(year ==2019)%>%
  summarise(median=median(sports_ball_rounded))
```
#### Explanation of Trash Wheel Data: 

The Mr. Trash Wheel data set has `r nrow(trash_wheel_final)` observations and `r ncol(trash_wheel_final)` columns after cleaning the data according to instructions. The data set includes the following variables: `r names(trash_wheel_final)`. The median number of sports balls in the year 2019 is `r trash_wheel_final%>% filter(year ==2019)%>%summarise(median=median(sports_ball_rounded))`.  

```{r}
precip_2019<- read_excel("./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 6, skip=1)
precip_2018<-read_excel("./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 7, skip=1)

head(precip_2019)
precip_2019_tidy<- precip_2019%>%
  janitor::clean_names()%>%
  mutate(year = 2019)%>%
  drop_na(month)%>%
  drop_na(total)

precip_2018_tidy<-precip_2018%>%
  janitor::clean_names()%>%
  mutate(year = 2018)%>%
  drop_na(month)%>%
  drop_na(total)

precip_2019_tidy
precip_2018_tidy

precip_combined<- bind_rows(precip_2019_tidy, precip_2018_tidy)%>%
  mutate(month = month.name[month])

#Total Precipitation in 2018
precip_combined%>%
  filter(year==2018)%>%
  summarise(sum(total))

```
#### Explanation of Precipitation Data: 

The combined precipitation data set has `r nrow(precip_combined)` observations and `r ncol(trash_wheel_final)` columns after cleaning the data according to instructions. The data set includes the following variables: `r names(precip_combined)`. The total precipitation in 2018 `r precip_combined%>%filter(year==2018)%>%summarise(sum(total))`inches.  

## Problem 2
#### pols-month data cleaning 
```{r}
pols_month<- read_csv("data/pols-month.csv")
head(pols_month)
pols_month_tidy<-pols_month%>%
  separate(mon, into = c("year", "month", "day"), sep="-")%>%
  mutate(
    month = replace(month, month=="01", "January"),
    month = replace(month, month=="02", "February"),
    month = replace(month, month=="03", "March"),
    month = replace(month, month=="04", "April"),
    month = replace(month, month=="05", "May"),
    month = replace(month, month=="06", "June"),
    month = replace(month, month=="07", "July"),
    month = replace(month, month=="08", "August"),
    month = replace(month, month=="09", "September"),
    month = replace(month, month=="10", "October"),
    month = replace(month, month=="11", "November"),
    month = replace(month, month=="12", "December"),
    pres = if_else(prez_dem>0, "dem", "gop"))%>%
  select(-prez_dem, -c(prez_dem, prez_gop, day))

```
#### snp data cleaning 
```{r}
snp<- read_csv("data/snp.csv")
head(snp)
snp_tidy<-snp%>%
  separate(date, into = c("month", "day", "year"), sep="/")%>%
  mutate(
    month = replace(month, month=="1", "January"),
    month = replace(month, month=="2", "February"),
    month = replace(month, month=="3", "March"),
    month = replace(month, month=="4", "April"),
    month = replace(month, month=="5", "May"),
    month = replace(month, month=="6", "June"),
    month = replace(month, month=="7", "July"),
    month = replace(month, month=="8", "August"),
    month = replace(month, month=="9", "September"),
    month = replace(month, month=="10", "October"),
    month = replace(month, month=="11", "November"),
    month = replace(month, month=="12", "December"),
    year_num = as.numeric(year), 
    year_clean = ifelse(year_num>21, 1900+year_num, 2000+year_num), 
    year = as.character(year_clean)
  )%>%
  select(year, month, close )
```
```{r}
unemployment<- read_csv("data/unemployment.csv")
head(unemployment)
```
#### unemployment data cleaning 
```{r}
unemployment_tidy_data <- 
  unemployment%>%
  pivot_longer(!Year, names_to = "month", values_to = "unemployment_percentage")%>%
  mutate(
    Year = as.character(Year),
    month = replace(month, month=="Jan", "January"),
    month = replace(month, month=="Feb", "February"),
    month = replace(month, month=="Mar", "March"),
    month = replace(month, month=="Apr", "April"),
    month = replace(month, month=="May", "May"),
    month = replace(month, month=="Jun", "June"),
    month = replace(month, month=="Jul", "July"),
    month = replace(month, month=="Aug", "August"),
    month = replace(month, month=="Sep", "September"),
    month = replace(month, month=="Oct", "October"),
    month = replace(month, month=="Nov", "November"),
    month = replace(month, month=="Dec", "December"))%>%
  janitor::clean_names()
head(unemployment_tidy_data)
```

```{r}
#Join pols_month_tidy with snp_tidy
joined_df = left_join(pols_month_tidy, snp_tidy, by = c("year", "month"))
#Join above data frame to unemployment
joined_df_full = left_join(joined_df, unemployment_tidy_data, by = c("year", "month"))
joined_df_full

joined_df_full%>%
  summarise(range = range(as.numeric(year)))
```
#### Explanation of Joined Five Thirty Eight Data: 
The combined Five Thirty Eight data set has `r nrow(joined_df_full)` observations and `r ncol(joined_df_full)` columns after cleaning the data according to instructions. The data set includes the following variables: `r names(joined_df_full)`. The combined data set combines pols_month, snp, and unemployment data sets.  "pols-month‚Äù contains 822 observations of 9 variables related to the number of national politicians who are democratic or republican at any given time. "snp" contains date and close, the closing values the S&P stock index on the associated date. "unemployment" contains the percentage of unemployment at that specific date. The range of years represented in the data set is 1947-2015. 

## Problem 3 

```{r}
baby_names<-read_csv("data/Popular_Baby_names.csv")
head(baby_names)

baby_names%>%
  janitor::clean_names()%>%
  distinct(ethnicity)

baby_names%>%
  janitor::clean_names()%>%
  distinct(gender)

baby_names%>%
  janitor::clean_names()%>%
  distinct(childs_first_name)


#Two ways of Asian and Pacific Islander being written and multiple ways of black non-Hispanic, and white non-Hispanic being written. Gender and first name variables look tidy already. 

baby_names_tidy<- baby_names%>%
  janitor::clean_names()%>%
  mutate(
    ethnicity = replace(ethnicity, ethnicity=="ASIAN AND PACI", "ASIAN AND PACIFIC ISLANDER"), 
    ethnicity = replace(ethnicity, ethnicity=="BLACK NON HISP", "BLACK NON HISPANIC"),
    ethnicity = replace(ethnicity, ethnicity=="WHITE NON HISP", "WHITE NON HISPANIC")
  )%>%
  distinct()

baby_names_tidy%>%
  filter(childs_first_name=="Olivia" & gender=="FEMALE")%>%
  pivot_wider(
  names_from = "year_of_birth", 
  values_from = "rank")%>%
  select(-c(gender, childs_first_name))%>%
knitr::kable(caption= "Rank in Popularity of the female baby name Olivia over time")
```
```{r}
baby_names_tidy%>%
  filter(childs_first_name=="Ethan" & gender=="MALE")%>%
  pivot_wider(
  names_from = "year_of_birth", 
  values_from = "rank")%>%
  select(-c(gender, childs_first_name))%>%
knitr::kable(caption= "Rank in Popularity of the male baby name Ethan over time")
```

```{r}
baby_names_tidy%>%
  filter(gender=="MALE" & ethnicity=="WHITE NON HISPANIC" & year_of_birth==2016)%>%
  ggplot(aes(x=rank, y = count))+geom_point()+labs(title = "Name Count vs. Name Rank for year 2016")
```


